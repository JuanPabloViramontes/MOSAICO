<!-- Selector de nivel de detalle -->
<div class="mb-3 text-end">
  <div class="btn-group" role="group">
    <button class="btn btn-outline-primary" [class.active]="matrizNivel === 'resumido'" (click)="matrizNivel = 'resumido'">Resumido</button>
    <button class="btn btn-outline-primary" [class.active]="matrizNivel === 'intermedio'" (click)="matrizNivel = 'intermedio'">Intermedio</button>
    <button class="btn btn-outline-primary" [class.active]="matrizNivel === 'completo'" (click)="matrizNivel = 'completo'">Completo</button>
  </div>
    <!-- Campo de bÃºsqueda -->
  <div class="search-container" style="width: 300px;">
    <div class="input-group">
      <input type="text" 
             class="form-control" 
             placeholder="Buscar buenas prÃ¡cticas..."
             [(ngModel)]="searchTerm"
             (keyup.enter)="applySearch()">
      <button class="btn btn-outline-primary" (click)="applySearch()">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </div>
</div>

<!-- Tabla -->
<div class="table-responsive">
  <table class="table table-bordered table-striped align-middle text-center">
    <thead class="table-primary">
      <tr>
        <th>Estado</th>
        <th>Naturaleza de la polÃ­tica pÃºblica</th>
        <th>Buena prÃ¡ctica</th>
        <th *ngIf="matrizNivel !== 'resumido'">Resumen de la buena prÃ¡ctica</th>
        <th *ngIf="matrizNivel !== 'resumido'">CategorÃ­a</th>
        <th *ngIf="matrizNivel !== 'resumido'">SubcategorÃ­a</th>
        <th *ngIf="matrizNivel === 'completo'" colspan="8">PoblaciÃ³n objetivo</th>
        <th *ngIf="matrizNivel === 'completo'">Actores involucrados</th>
      </tr>
      <tr *ngIf="matrizNivel === 'completo'">
        <th colspan="6"></th>
        <th>Retornado(a)s</th>
        <th>TrÃ¡nsito</th>
        <th>Mexicanos en el extranjero</th>
        <th>Refugiado(a)s y asilado(a)s</th>
        <th>MigraciÃ³n de destino</th>
        <th>MigraciÃ³n interna</th>
        <th>PoblaciÃ³n no migrante</th>
        <th>Personas desplazadas internas</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let row of filteredData">
        <td>{{ row.estado }}</td>
        <td>{{ row.naturaleza_politica_publica }}</td>
        <td>
          <button class="btn btn-link text-primary text-decoration-underline p-0" (click)="openModal(row)">
            {{ row.buena_practica }}
          </button>
        </td>

        <td *ngIf="matrizNivel !== 'resumido'">{{ row.resumen }}</td>
        <td *ngIf="matrizNivel !== 'resumido'">{{ row.categoria }}</td>
        <td *ngIf="matrizNivel !== 'resumido'">{{ row.subcategoria }}</td>

        <ng-container *ngIf="matrizNivel === 'completo'">
          <td [title]="'Migrantes retornados'">{{ row.poblacion_objetivo?.retornados === 1 ? 'ğŸ”ğŸ™‹â€â™‚ï¸' : 'âŒ' }}</td>
<td [title]="'Migrantes en trÃ¡nsito'">{{ row.poblacion_objetivo?.transito === 1 ? 'ğŸš¶â€â™€ï¸ğŸŒ«ï¸' : 'âŒ' }}</td>
<td [title]="'Mexicanos en el extranjero'">{{ row.poblacion_objetivo?.mexicanos_extranjero === 1 ? 'ğŸ¤ğŸŒ' : 'âŒ' }}</td>
<td [title]="'Refugiados / Asilados'">{{ row.poblacion_objetivo?.refugiados_asilados === 1 ? 'ğŸ›¡ï¸ğŸ§' : 'âŒ' }}</td>
<td [title]="'MigraciÃ³n internacional'">{{ row.poblacion_objetivo?.migracion_destino === 1 ? 'ğŸŒğŸ§‘â€ğŸ¤â€ğŸ§‘' : 'âŒ' }}</td>
<td [title]="'MigraciÃ³n interna'">{{ row.poblacion_objetivo?.migracion_interna === 1 ? 'ğŸ˜ï¸ğŸ”„' : 'âŒ' }}</td>
<td [title]="'PoblaciÃ³n no migrante'">{{ row.poblacion_objetivo?.poblacion_no_migrante === 1 ? 'ğŸ“ğŸ§‘â€ğŸ¤â€ğŸ§‘' : 'âŒ' }}</td>
<td [title]="'Personas desplazadas internas'">{{ row.poblacion_objetivo?.personas_desplazadas === 1 ? 'âš ï¸ğŸšï¸' : 'âŒ' }}</td>
          <td>{{ row.actores_involucrados }}</td>
        </ng-container>
      </tr>

      <tr *ngIf="filteredData.length === 0">
        <td [attr.colspan]="matrizNivel === 'resumido' ? 3 : matrizNivel === 'intermedio' ? 6 : 15" class="text-center">
          No hay buenas prÃ¡cticas para esta selecciÃ³n.
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<app-modal-practica
  *ngIf="modalVisible && selectedPractica"
  [show]="modalVisible"
  [practica]="selectedPractica"
  [filteredData]="filteredData"
  (closeModal)="closeModal()">
</app-modal-practica>
